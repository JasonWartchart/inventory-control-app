{% extends "base.html" %}  <!-- üß± K·∫ø th·ª´a giao di·ªán chung -->

{% block title %}M∆∞·ª£n h√†ng{% endblock %}  <!-- üè∑ Ti√™u ƒë·ªÅ hi·ªÉn th·ªã tr√™n tr√¨nh duy·ªát -->

{% block content %}
<h2>üì¶ M∆∞·ª£n h√†ng</h2>

<!-- üîç Form t√¨m ki·∫øm s·∫£n ph·∫©m b·∫±ng Code -->
<form method="GET" action="/borrow">
    Nh·∫≠p m√£ s·∫£n ph·∫©m (Code):
    <input type="text" name="code" required>
    <button type="submit">T√¨m</button>
</form>

<hr>

<!-- üìã N·∫øu t√¨m ƒë∆∞·ª£c s·∫£n ph·∫©m th√¨ hi·ªÉn th·ªã th√¥ng tin -->
{% if thong_tin %}
    <h4>üìã Th√¥ng tin s·∫£n ph·∫©m:</h4>
    <ul>
        {% for col, val in thong_tin.items() %}
            <li><strong>{{ col }}:</strong> {{ val }}</li>  <!-- üí° Duy·ªát t·ª´ng c·ªôt -->
        {% endfor %}
            {% if '·∫¢nh m∆∞·ª£n' in thong_tin and thong_tin['·∫¢nh m∆∞·ª£n'] %}
            <li>
                <strong>·∫¢nh m∆∞·ª£n:</strong>
                <img src="{{ url_for('static', filename='images/borrow/' + thong_tin['·∫¢nh m∆∞·ª£n']) }}" width="200">
            </li>
        {% else %}
            <li><strong>·∫¢nh m∆∞·ª£n:</strong> <span style="color:gray;">(Kh√¥ng c√≥ ·∫£nh)</span></li>
        {% endif %}

        
    </ul>

    <!-- ‚ùå N·∫øu t√¨nh tr·∫°ng l√† Unavailable th√¨ b√°o popup -->
    {% if thong_tin["T√¨nh tr·∫°ng"] == "Unavailable" %}
        <script>alert("‚ùå S·∫£n ph·∫©m kh√¥ng kh·∫£ d·ª•ng (ƒëang ƒë∆∞·ª£c m∆∞·ª£n).");</script>

    <!-- ‚úÖ N·∫øu t√¨nh tr·∫°ng l√† Available th√¨ hi·ªÉn th·ªã v·ªã tr√≠ + form m∆∞·ª£n -->
    {% elif thong_tin["T√¨nh tr·∫°ng"] == "Available" %}

        <!-- üìç Chuy·ªÉn ƒë·ªïi v·ªã tr√≠ '3A1' ‚Üí 'K·ªá 3 - H√†ng A - √î 1' -->
        {% set vi_tri = thong_tin["V·ªã tr√≠"] %}
        {% set hien_thi = "K·ªá " ~ vi_tri[0] ~ " - H√†ng " ~ vi_tri[1] ~ " - √î " ~ vi_tri[2] %}
        <script>alert("‚úÖ V·ªã tr√≠ s·∫£n ph·∫©m: {{ hien_thi }}");</script>


        
        <!-- üß† Hi·ªÉn th·ªã tr·∫°ng th√°i -->
        <p style="color: {{ mau_trang_thai }};">
            üìä Tr·∫°ng th√°i: {{ icon }} <strong>{{ trang_thai }}</strong> ({{ tile }}%)
        </p>
        

        <!-- üñº Form x√°c nh·∫≠n m∆∞·ª£n s·∫£n ph·∫©m -->
        <form method="POST" action="/muon-xac-nhan" enctype="multipart/form-data">
            <input type="hidden" name="code" value="{{ thong_tin['Code'] }}">  <!-- G·ª≠i m√£ s·∫£n ph·∫©m -->

            Ch·ª•p ·∫£nh s·∫£n ph·∫©m ƒë√£ m∆∞·ª£n:
            <input type="file" name="anh_muon" accept="image/*" required><br><br>

            <button type="submit">‚úÖ M∆∞·ª£n h√†ng</button>
        </form>
    {% endif %}

<!-- ‚ö†Ô∏è N·∫øu kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ‚Üí b√°o l·ªói -->
{% elif thong_bao %}
    <script>alert("{{ thong_bao }}");</script>
{% endif %}

{% endblock %}
